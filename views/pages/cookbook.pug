extends ../layout.pug

block content
	.container
		h1.mb-Lg The Lissner Cookbook
			if user && user.isAdmin
				button.btn.btn-primary.f-R(data-toggle='modal', data-target='#AddRecipie') Add Recipie

		if user && user.isAdmin
			+modal('AddRecipie')
				+RecipieForm('add')
		.hidden-xs.col-sm-2
			div(data-function='stickey')
				div(data-stickey='content-wrapper')
					div(data-stickey='content')
						h2 Filter
						#CookbookFilter(data-function='filter')
							- var mealTypes = [];
							h3 Meal Type
							div(data-filter-section='meal')
								for recipe, i in recipes
									for type in recipe.mealType ? recipe.mealType : []
										if mealTypes.indexOf(type) === -1
											.checkbox
												label
													input(type='checkbox', value= type)
													= type
											- mealTypes.push(type)

							- var dishTypes = [];
							h3 Dish Type
							div(data-filter-section='dish')
								for recipe, i in recipes
									for type in recipe.dishType ? recipe.dishType : []
										if dishTypes.indexOf(type) === -1
											.checkbox
												label
													input(type='checkbox', value= type)
													= type
											- dishTypes.push(type)

							- var ethnicities = [];
							h3 Ethnicity
							div(data-filter-section='ethnicity')
								for recipe, i in recipes
									for type in recipe.ethnicity ? recipe.ethnicity : []
										if ethnicities.indexOf(type) === -1
											.checkbox
												label
													input(type='checkbox', value= type)
													= type
											- ethnicities.push(type)

							- var difficulties = ['Easy', 'Medium', 'Hard', 'Advanced'];
							h3 Difficulty
							div(data-filter-section='difficulty')
								for difficulty in difficulties
									.checkbox
										label
											input(type='checkbox', value= difficulty)
											= difficulty

							h3 Dietary Restrictions
							.checkbox(data-filter-section='gluten')
								label
									input(type='checkbox', value='true')
									| Gluten Free
							.checkbox(data-filter-section='dairy')
								label
									input(type='checkbox', value='true')
									| Dairy Free
							.checkbox(data-filter-section='veggy')
								label
									input(type='checkbox', value='true')
									| Vegetarian

		#CookbookFoods.col-xs-12.col-sm-10
			for recipe, i in recipes
				.row.mtb-Sm(data-filter-dish= recipe.dishType && recipe.dishType.join('|') || 'Unknown', data-filter-ethnicity= recipe.ethnicity && recipe.ethnicity.join('|') || 'Unknown', data-filter-difficulty= recipe.difficulty || 'Unknown', data-filter-meal= recipe.mealType && recipe.mealType.join('|') || 'Unknown', data-filter-gluten= recipe.isGlutenFree ? 'true' : 'false', data-filter-dairy= recipe.isDairyFree ? 'true' : 'false', data-filter-veggy= recipe.isVegetarian ? 'true' : 'false')
					.col-xs-12.col-sm-5.col-md-3
						img.w-100(src= getImagePath(recipe.image, 'medium'), alt= recipe.name)
					.col-xs-12.col-sm-7.col-md-9
						h2.mt-0= recipe.name
							small= ` ${recipe.author}`
						ul.fc-G__dk.fs-Sm.list-inline
							if recipe.isGlutenFree
								li.pr-0 Gluten Free |
							if recipe.isVegetarian
								li.pr-0 Vegetarian |
							if recipe.isDairyFree
								li.pr-0 Dairy Free |
							li(data-icon='fa fa-clock-o')= ` ${recipe.time}`
							if recipe.serves
								li.pl-0= `| Serves ${recipe.serves}`
						if recipe.description && wysiwygHasData(recipe.description)
							div!= recipe.description

						a(href=`/${recipe.url}`) Full Recipe
	script(src='/js/pages/cookbook.min.js')